<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title></title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.isotope.min.js"></script>
    <script src="js/jquery.prettyPhoto.js"></script>
    <script src="js/main.js"></script>

    
    <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.min.js"></script>
    <![endif]-->
    
  
</head><!--/head-->

<body overflow-x="scroll" data-target="#navbar" data-offset="0">
    <header id="header" role="banner">
        <div class="container">
            <div id="navbar" class="navbar navbar-default">
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="#main-slider"><i class="icon-home"></i></a></li>
                        <li><a href="index.html">Accueil</a></li>
                        <li><a href="Rapport.html">Rapport du projet</a></li>
                    </ul>
                </div>
                

            </div>
        </div>
    </header>
    <section id="main-slider" class="carousel">
        <div class="container">
            <div class="carousel-content">
                <h1>Rapport du projet</h1>
                <p class="lead">Challenge Open Data</p>
            </div>
        </div>
    </section>

    <section id="intro">
        <div class="box1">
            <div classe = "introbox">
            <h3>Introduction:</h3>
            <p>Dans le cadre de ce projet, nous etions amené à réaliser une application web de visualisation interactive de données , nous avons pour cela choisi de travailler sur des données liées au domaine de l'énergie pour arriver à la fin  à trouver les regions autonomes de la France en terme de production et consommation d'énergie</p>

           <h3>Démarche Complète de l'application </h3>
              <h4>Source de données:</h4>
                  <p>Notre application est basée sur les données issues de la base de données régionale et départementale sur l'environnement, l'énergie, le transport, le logement et la construction : <a href="http://www.stats.environnement.developpement-durable.gouv.fr/Eider/">Eider</a>. Nous nous somes servi pour en extraire les données sur l'énergie primaire: il s'agit d'une serie longue de données allant de 1999 jusqu'à 2009 tout en choisissant un filtre soit par regions, par départements ou bien sur toute la France. Cela nous a permi d'avoir l'évolution de la production et la consommation au cours des année et pouvoir faire des comparaisons entre les differntes regions.</p>
             <h4>Traitements Opérés:</h4>
                  <p>Le traitement que nous avons envisagé sur les données est de faire en sorte qu'à partir de 2 fichiers csv (consommation et production ), nous générons un fichier de format JSON qui englobe à la fois les données lié a la consommation, la production et la difference production-consomation(critère d'autonomie). Pour cela nous avons utilisé un script Python qui fait le traitement automatique sur nos données. </p>
            <h4> Architecture de l'application:</h4>
                 <p>L'Architecture de notre application est composée de 3 parties. Dans un premier lieu on trouve le classement des regions de la France en terme d'autonomie c'est à dire savoir laquelle des regions de la France est la plus autonome(elle consomme ce quelle produit). Ensuite on visualise plus de details et cela en affichant le classement des regions de France au cours de 10 années (de 1999 jusqu'à 2009). et à la fin on retrouve un histogramme détaillé pour une année précise. </p>
                 <p>Nous avons pensé à rendre notre application plus interactive en ajoutant des options qui permettent à l'utilisateur de choisir les critères qu'il veut visualiser, il peut selectionner soit de visualiser la consommation, soit la production soit l'excédent, ainsi qu'il peut choisir de trier l'histogramme et avoir les regions triées par rapport au critère qu'il a selectionné. </p>


            </div>
        </div>
    </section>

    <section id="Historique">
        <div class="box">
            <h1> </h1>
            <div id="r">

            </div>
        </div>
    </section>

    <section id="Detail">
            <div class="box">
                <div id="">

                </div>
            </div>
    </section>

    <footer id="footer">
        <div class="container">
            <div class="row">
                <div class="col-sm-6">
                    &copy; 2017 All Rights Reserved.
                </div>
            </div>
        </div>
    </footer>
    <script>
        var queries = {
                display_value: 'input[name="choice"]',
                sorted: '#sort',
                years: '#year'
            },
            selections = [];
        
        runRankChart({
            currentYear: "1990",
            comparedValue: "diff",
            dataPath: "rankChart/data.json",
            DOMcontainer: "#rank-chart"
        }, callbackChangeYear, callbackChangeSelection)
        
        $(queries.display_value).on('change', function() {
            confRankChart.comparedValue = $(this).val()
        });

        $(queries.years).on('change', function() {
            confRankChart.currentYear = $(queries.years + " option:selected").text()
        });

        //Load data and call bar chart function
        d3.json("bar-chart/diff.json", function(error,data){
            dataset = data;
            if(error){
                console.log(error);
            }else{
                var conf = $.extend({}, CHART.settings);
                conf.h = 400;
                conf.displayValue = d3.select('input[name="choice"]:checked').attr('value');

                c = CHART.chart(data, conf);
                c.update(conf);
                c.createSelect("#year");

                CHART.bindToDom(queries, c);
            }

        });

        function callbackChangeYear(newYear){
            $("#year option").each(function(index, option){
                if ($(option).text() == newYear)
                    $("#year").val(index);
                    $("#year").change();
            })
        }
        
        function callbackChangeSelection(region, addOrRemove){
            if (addOrRemove){
                selections.push(region)
            }
            else{
                selections.forEach(function(r, i){
                    if (r == region)
                        selections.splice(i, 1);
                })
            }
            
            confRankChart.selection = selections.slice(0);
            //TODO call change in bar chart
        }
        
    </script>
</body>
</html>